# 服务端
## 接收数据约定字段
* action
    1. 代表某些行为
    2. 可选值：
        getData：代表获取图表数据
        fullScreen：代表产生了全屏事件
        themeChange：代表产生了主题切换事件
* socketType
    1. 代表业务模块类型
    2. 代表前端响应函数的标识
    3. 可选值：
        trendData, sellerData, mapData, rankData, hotData, stockData, fullScreen, themeChange
* charName
    1. 图表的名称
        trend, seller, map, rank, hot, stock
    2. 如果是主题事件，可以不传递此值
        因为主题切换事件是需要所有组件都要切换，而全屏和获取数据需要标识出是哪个图表
* value
    1. 代表具体的数据值
    2. 如果是全屏事件，true 代表全屏，false 代表非全屏
       如果是主题切换事件，可选值有 chalk 或者 vintage
## 发送数据约定字段
* 接收的 action == getData
    1. 取出数据中的charName字段
    2. 拼接json文件的路径
    3. 读取该文件的内容
    4. 在接收到的数据基础之上，增加data字段
* 接收的 action !== getData
    * 原封不动的将客户端接收到的数据，转发给每一个处于连接状态的客户端

## 服务端
1. 使用 koa 中间件（三层结构）
    1. 第一层：计算服务器总耗时的中间件
    2. 第二层：设置响应头中间件
    3. 第三层：处理业务逻辑，读取文件数据
2. 绑定端口 8888
3. webSocketService.listen() 开启服务端的监听，监听客户端的连接
    * 当客户端连接承购之后，就会对这个客户端进行 message 事件的监听
### websocket
1. 引入路径、读文件api、WebSocket，设置端口
2. 服务端开启监听（连接事件的监听）
    1. 连接成功后，对连接对象进行 message 事件监听
    2. 整个事件使用 async-await （读取数据返回的是 Promise 对象）
    3. 解析客户端发送的 json 数据，得到 payload
    4. 查看 action 的值，查看客户端的意图（payload.action）
        * action === 'getData' 
            1. 从  payload.charName 得到想要获取的图表的数据
            2. 设置相对文件路径
            3. 设置绝对路径
            4. 使用 fileUtils api 获取数据
            5. 数据添加到返回的 payload.data 属性中
            6. 将返回的数据进行 JSON.stringify，返回 JSON 数据给客户端
        * action !== 'getData'
            1. 将接受到的数据返回给所有连接的客户端

## 客户端
